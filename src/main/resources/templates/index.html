<!DOCTYPE html>
<html th:lang="${#locale.language}"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:replace="fragments/head :: head(additionalCss='/css/index.css')"></head>
<body>
<header th:replace="fragments/navbar"></header>

<main>
    <section class="hero section">
        <div>

            <h1 class="hero-title"
                th:if="${#authentication != null and #authentication.name != 'anonymousUser'}"
                th:text="#{greeting.user(${#authentication.name})}">
            </h1>

            <h1 class="hero-title"
                th:unless="${#authentication != null and #authentication.name != 'anonymousUser'}"
                th:text="#{greeting}">
            </h1>

            <p th:text="#{slogan}">Find your next car with ease ‚Äî explore trusted offers, compare prices, and connect
                with verified
                sellers.</p>
            <a th:href="@{/offers/find}"
               class="cta-btn"
               th:text="#{button.browse}">Browse offers üöó</a>
        </div>
    </section>

    <div th:if="${flashMessage}" class="alert-toast alert-success">
        <span class="alert-icon">
            <img src="/images/car-travel-delete.svg" alt="icon">
        </span>
        <span th:text="${flashMessage}"></span>
    </div>

    <th:block th:replace="fragments/quick-search :: quickSearch(
    ${offersFindBindingModel},${categories},${brands},${models})">
    </th:block>

    <th:block th:replace="fragments/offers-section :: offersSection(
    #{recent},${latestOffers},'offers.none',@{/offers/all},'all.offers')">
    </th:block>

    <th:block th:replace="fragments/offers-section :: offersSection(
    #{offers.mostViewed},${mostViewedOffers},'offers.none',@{/offers/top-offers},'button.top20')">
    </th:block>

    <section class="vehicle-grid section">
        <th:block
                th:replace="fragments/brand-card :: vehicleCard('bmw','BMW','https://cdn.simpleicons.org/bmw/999999')"/>
        <th:block
                th:replace="fragments/brand-card :: vehicleCard('audi','Audi','https://cdn.simpleicons.org/audi/999999')"/>
        <th:block
                th:replace="fragments/brand-card :: vehicleCard('toyota','Toyota','https://cdn.simpleicons.org/toyota/999999')"/>
        <th:block
                th:replace="fragments/brand-card :: vehicleCard('mercedes','Mercedes','https://cdn.simpleicons.org/mercedes-benz/999999')"/>
        <th:block
                th:replace="fragments/brand-card :: vehicleCard('volkswagen','Volkswagen','https://cdn.simpleicons.org/volkswagen/999999')"/>
        <th:block
                th:replace="fragments/brand-card :: vehicleCard('dacia','Dacia','https://cdn.simpleicons.org/dacia/999999')"/>
        <th:block
                th:replace="fragments/brand-card :: vehicleCard('tesla','Tesla','https://cdn.simpleicons.org/tesla/999999')"/>
        <th:block
                th:replace="fragments/brand-card :: vehicleCard('honda','Honda','https://cdn.simpleicons.org/honda/999999')"/>
        <th:block
                th:replace="fragments/brand-card :: vehicleCard('ford','Ford','https://cdn.simpleicons.org/ford/999999')"/>
        <th:block
                th:replace="fragments/brand-card :: vehicleCard('nissan','Nissan','https://cdn.simpleicons.org/nissan/999999')"/>
        <th:block
                th:replace="fragments/brand-card :: vehicleCard('hyundai','Hyundai','https://cdn.simpleicons.org/hyundai/999999')"/>
        <th:block
                th:replace="fragments/brand-card :: vehicleCard('kia','Kia','https://cdn.simpleicons.org/kia/999999')"/>
    </section>

    <section class="why-choose-us section">
        <h2 class="section-title"
            th:utext="#{why.choose('<span class=&quot;brand-name&quot;>Mobilele</span>')}">
            Why choose <span class="brand-name">Mobilele</span>?
        </h2>
        <div class="features-grid">
            <div class="feature rating-feature ui-transition glass-effect">
                <i class="fa fa-star"></i>
                <h3 th:text="#{community.rating}">Our Community Rating</h3>

                <div class="rating-info ui-transition">
                    <div class="stars">
                        <i class="fa fa-star"
                           th:each="i : ${#numbers.sequence(1,5)}"
                           th:classappend="${i <= summary.rating} ? 'filled' : ''"></i>
                    </div>
                    <p class="rating-average">
                        <span th:text="${#numbers.formatDecimal(summary.rating, 1, 1)}">4.8</span> / 5
                    </p>
                    <p class="rating-count"
                       th:text="#{reviews.based(${summary.count})}">
                        Based on 124 reviews
                    </p>
                </div>
            </div>

            <div class="feature ui-transition glass-effect">
                <i class="fa fa-shield"></i>
                <h3 th:text="#{sellers.verified}">Verified Sellers</h3>
                <p th:text="#{sellers.verified.desc}">Every seller is verified for authenticity and trustworthiness.</p>
                <p class="feature-link">
                    <a th:text="#{btn.sellers.top}"
                       th:href="@{/sellers/top}"
                       class="text-link">
                        View our top sellers ‚Üí
                    </a>
                </p>
            </div>

            <div class="feature ui-transition glass-effect">
                <i class="fa fa-car"></i>
                <h3 th:text="#{selection.title}">Wide Selection</h3>
                <p th:text="#{selection.desc}">Thousands of offers from top brands and private owners.</p>
                <p th:text="#{selection.stats(${soldCount}, ${startYear})}">
                    Successfully sold 6 vehicles since 2025.
                </p>
            </div>

            <div class="feature ui-transition glass-effect">
                <i class="fa fa-clock-o"></i>
                <h3 th:text="#{fast.title}">Fast & Easy</h3>
                <p th:text="#{fast.desc}">Filter, compare, and contact sellers ‚Äî all in under a minute.</p>
            </div>

            <div class="feature ui-transition glass-effect">
                <i class="fa fa-money"></i>
                <h3 th:text="#{prices.title}">Transparent Prices</h3>
                <p th:text="#{prices.desc}">No hidden fees. See clear, real-time offers you can trust.</p>
            </div>
        </div>
    </section>

    <section class="reviews section">
        <h2 th:text="#{users.say}" class="section-title">What our users say ‚≠ê</h2>

        <div class="reviews-marquee">
            <div class="reviews-track">
                <div class="review-card glass-effect" th:each="feed : ${feedbacks}">
                    <div class="review-header">
                        <div class="review-info">
                            <span class="review-name"
                                  th:text="${feed.userFirstName + ' ' + feed.userLastName}">John Doe</span>
                            <span class="review-date"
                                  th:text="${#temporals.format(feed.created, 'dd MMM yyyy')}">10 Nov 2025</span>
                        </div>

                        <!-- Stars -->
                        <div class="review-stars">
                            <i class="fa fa-star"
                               th:each="i : ${#numbers.sequence(1,5)}"
                               th:classappend="${i <= feed.rating} ? 'filled' : ''"></i>
                        </div>
                    </div>

                    <p class="review-comment" th:text="${feed.comment}">
                        Great experience! Easy to find my dream car.
                    </p>
                </div>
            </div>
        </div>
    </section>
</main>

<footer th:replace="fragments/footer"></footer>
</body>

<script th:src="@{/js/loadModels.js}"></script>
<script th:src="@{/js/toggleSearchInputs.js}"></script>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const toast = document.querySelector(".alert-toast");
        if (toast) {
            toast.classList.add("show");
            setTimeout(() => {
                toast.classList.remove("show");
            }, 4500); // 4.5s visible
        }
    });
</script>
</html>
